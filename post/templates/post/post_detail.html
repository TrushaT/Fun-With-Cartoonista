{% extends 'cartoonify/base.html' %}
{% load social_share %}

{% block content %}
<h1 class="mt-3 mb-3 text-center"> {{ post.title }} </h1>
<div class="mt-2 text-center"> 
    <img src="{{ post.header_image.url }}" class="img-fluid"> 
    {% if user == object.author %}
    <div class="mt-2 text-center">
        <a class="btn btn-success mt-2" href="{% url 'update_post' post.pk  %}">Edit</a>
        <a class="btn btn-danger mt-2" href="{% url 'delete_post' post.pk  %}">Delete</a>
        <a href="{{ post.header_image.url }}" download>
       
    </div>
    {% else %}
    {% endif %}
    {% if user.is_authenticated %}
        {% if user in post.likes.all %}
            <p><a class='like-btn' data-href="{{ post.get_api_like_url }}" data-likes="{{ post.likes.count }}" href=""> {{ post.likes.count }} Unlike</a></p>
        {% else %}
            <p><a class='like-btn' data-href="{{ post.get_api_like_url }}" data-likes="{{ post.likes.count }}" href=""> {{ post.likes.count }} Like</a></p>
        {% endif %}
         <a href="{{ post.header_image.url }}" class="btn btn-outline-success btn-sm" download>  Download</a>
        {% post_to_facebook object_or_url  'Post to fb!' %}
        {% send_email post.title "Interesting Photo: {{post.title}}. Check it out!" object_or_url "Share via email" %}
        {% post_to_whatsapp object_or_url "Share ur whatsapp" %}

    {% else %}
        <p><a class='like-btn' href="{% url 'login' %}"> {{ post.likes.count }} Like{{ post.likes.count|pluralize }}</a></p>
    {% endif %}
    <p class="h6"> Tags: {% for tag in post.tags.all %}<a class='btn btn-primary' href="{% url 'per-category' tag.slug %}">{{ tag.name }}</a>{% if not forloop.last %} {% endif %}{% endfor %}</p> 
    {% if related_posts %}
    <p class="h6">Similar Posts: {% for post in related_posts %}<a class='btn btn-secondary' href="{% url 'detail_post' post.id %}">{{ post.title }}</a>{% if not forloop.last %} {% endif %}{% endfor %}</p> 
    {% endif %}
</div>
{% endblock content %}
